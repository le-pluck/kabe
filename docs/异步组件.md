# 异步组件

官方文档：[异步组件 | Vue.js](https://cn.vuejs.org/guide/components/async.html#async-components)

在大型项目中，我们可能需要拆分应用为更小的块，并仅在需要时再从服务器加载相关组件。Vue 提供了 `defineAsyncComponent` 方法来实现此功能。

## * 从服务器加载 (未实践)

我的项目还没优化到这一步，目前还没有从服务器加载相关组件的代码。

贴出官方代码：

``` js
import { defineAsyncComponent } from 'vue'

const AsyncComp = defineAsyncComponent(() => {
  return new Promise((resolve, reject) => {
    // ...从服务器获取组件
    resolve(/* 获取到的组件 */)
  })
})
// ... 像使用其他一般组件一样使用 `AsyncComp`
```

## 导入

导入同步组件：

``` js
import PosterProfile from "@/components/home/PosterProfile.vue";
```

导入异步组件：

``` js
import { defineAsyncComponent } from 'vue'
const PosterProfile = defineAsyncComponent(
  () => import("@/components/home/PosterProfile.vue")
);
```

## Suspense

官方文档：[Suspense | Vue.js](https://cn.vuejs.org/guide/built-ins/suspense.html)

`<Suspense>` 是一个内置组件，用来在组件树中协调对异步依赖的处理。它让我们可以在组件树上层等待下层的多个嵌套异步依赖项解析完成，并可以在等待时渲染一个加载状态。

`<Suspense>` 组件有两个插槽：`#default` 和 `#fallback`。两个插槽都只允许一个直接子节点。在可能的时候都将显示默认槽中的节点。否则将显示后备槽中的节点。

``` html
<template>
  <v-card loading class="previewer">
    <Suspense>
      <template #default>
        <PosterProfile :poster-id="posterId"></PosterProfile>
      </template>
      <template #fallback>
        <v-skeleton-loader type="list-item-avatar"></v-skeleton-loader>
      </template>
    </Suspense>
    <!-- ...... -->
</template>
```

## 合适的加载动画 Skeleton loaders

目前 Vuetify 提供的骨架加载动画 Skeleton loaders 处于实验阶段。

[什么是实验阶段？](https://vuetifyjs.com/en/labs/introduction/#what-is-labs)

使用未发布的功能 —— Experiment and use in-development components before they're released.

导入方式：

``` js
import { VSkeletonLoader } from "vuetify/labs/VSkeletonLoader";
```